{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome # This is a template docs for any kind of repositories. Prerequisite # Docker Engine GNU Make Commands # make view - Start the live-reloading docs server. make build - Build the documentation site. make init - Remove .git of docs repository. About MkDocs # See https://www.mkdocs.org/","title":"Welcome"},{"location":"#welcome","text":"This is a template docs for any kind of repositories.","title":"Welcome"},{"location":"#prerequisite","text":"Docker Engine GNU Make","title":"Prerequisite"},{"location":"#commands","text":"make view - Start the live-reloading docs server. make build - Build the documentation site. make init - Remove .git of docs repository.","title":"Commands"},{"location":"#about-mkdocs","text":"See https://www.mkdocs.org/","title":"About MkDocs"},{"location":"customize/","text":"Customize # See https://squidfunk.github.io/mkdocs-material/","title":"Customize"},{"location":"customize/#customize","text":"See https://squidfunk.github.io/mkdocs-material/","title":"Customize"},{"location":"faq/","text":"FAQ # Q. Nests of list are not working # A. Make sure the indent is with 4 spaces. If you used prettier for formatting md files, override the settings as per .prettierrc file in this repository.","title":"FAQ"},{"location":"faq/#faq","text":"","title":"FAQ"},{"location":"faq/#q-nests-of-list-are-not-working","text":"A. Make sure the indent is with 4 spaces. If you used prettier for formatting md files, override the settings as per .prettierrc file in this repository.","title":"Q. Nests of list are not working"},{"location":"how_to_use/","text":"How to use # Clone # Clone this repository to your repository cd docs && make init This operation removes .git directory of docs aa Setting up # Edit your/repository/docs/mkdocs.yaml and setup the docs make view and check the appearance Build and Publish # make build and site directory will be generated Branch gh-pages and delete all files except site directory Extract site directory to repository root and push gh-pages branch The page is hosted at https://pages.github.ibm.com/ username / reponame","title":"How to use"},{"location":"how_to_use/#how-to-use","text":"","title":"How to use"},{"location":"how_to_use/#clone","text":"Clone this repository to your repository cd docs && make init This operation removes .git directory of docs aa","title":"Clone"},{"location":"how_to_use/#setting-up","text":"Edit your/repository/docs/mkdocs.yaml and setup the docs make view and check the appearance","title":"Setting up"},{"location":"how_to_use/#build-and-publish","text":"make build and site directory will be generated Branch gh-pages and delete all files except site directory Extract site directory to repository root and push gh-pages branch The page is hosted at https://pages.github.ibm.com/ username / reponame","title":"Build and Publish"},{"location":"kubernetes-study-ingress/","text":"Ingress # Ingress \u3068\u306f\uff1f # Ingress \u306f Ingress \u30ea\u30bd\u30fc\u30b9 \u304a\u3088\u3073 Ingress Controller \u306a\u3069\u3092\u6307\u3059\u3002 Ingress \u30ea\u30bd\u30fc\u30b9\u306f kind: Ingress \u306e \u30de\u30cb\u30d5\u30a7\u30b9\u30c8 \u3092\u767b\u9332\u3059\u308b\u3053\u3068\u3067\u4f5c\u6210\u3055\u308c\u3001\u305d\u306e\u767b\u9332\u6642\u306b\u4f55\u3089\u304b\u306e\u51e6\u7406\u3092\u884c\u3046\u3082\u306e\u304c Ingress Controller \u3067\u3042\u308b\u3002 \u3053\u308c\u3089\u306b\u3088\u308a\u3001\u30ce\u30fc\u30de\u30eb\u306a Service \u3067\u306f\u5b9f\u73fe\u56f0\u96e3\u306a\u3088\u308a\u9ad8\u6a5f\u80fd\u306a\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u53ef\u80fd\u3068\u306a\u308b\u3002Ingress \u306f L7 \u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3092\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u3002 LB \u306e\u7a2e\u985e \u6a5f\u80fd \u4f8b L4 IP \u30a2\u30c9\u30ec\u30b9\u3068\u30dd\u30fc\u30c8\u756a\u53f7\u306b\u3088\u308b\u8ca0\u8377\u5206\u6563 AWS \u306e Application Load Balancer L7 URL \u3084 HTTP \u30d8\u30c3\u30c0\u30fc\u3067\u8ca0\u8377\u5206\u6563 AWS \u306e Network Load Balancer Ingress \u306e\u7a2e\u985e # \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u89b3\u70b9\u304b\u3089 2 \u3064\u306b\u5927\u5225\u3055\u308c\u308b\u3002 1. GKE Ingress # \u30af\u30e9\u30b9\u30bf\u5916\u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u7acb\u3066\u308b\u3082\u306e\u3002 \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306e\u6d41\u308c 1 \u5916\u90e8\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5(GCLB) -> (NodePort \u7d4c\u7531) -> \u8ee2\u9001\u5148\u306e Pod 2. Nginx Ingress # \u30af\u30e9\u30b9\u30bf\u5185\u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u7acb\u3066\u308b\u3082\u306e\u3002 \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306e\u6d41\u308c(Nginx Ingress) 1 LoadBalancer Service -> Nginx Pod(Nginx Ingress Controller) -> \u8ee2\u9001\u5148\u306e Pod \u3053\u3061\u3089\u306e\u30d1\u30bf\u30fc\u30f3\u306e\u5834\u5408\u3001\u8003\u616e\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u70b9\u304c\u591a\u304f\u3001Ingress \u7528 Pod \u306b\u5916\u90e8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3055\u305b\u308b\u305f\u3081\u306b LoadBalancer Service \u3092\u7acb\u3066\u305f\u308a\u3001Ingress \u7528\u306e Pod \u306b\u51e6\u7406\u304c\u96c6\u4e2d\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u30aa\u30fc\u30c8\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u3092\u8003\u616e\u3059\u308b\u5fc5\u8981\u3082\u51fa\u3066\u304f\u308b\u3002 Ingress Controller \u306e\u30c7\u30d7\u30ed\u30a4 # 1. GKE Ingress # \u30af\u30e9\u30b9\u30bf\u4f5c\u6210\u6642\u306b HttpLoadBalancer \u30a2\u30c9\u30aa\u30f3\u3092\u6709\u52b9\u5316\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u305d\u3046\u306a\u3063\u3066\u3044\u308b)\u3002 2. Nginx Ingress # Nginx Ingress Controller \u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3002 1 $ kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.3.1/deploy/static/provider/cloud/deploy.yaml \u307e\u305f\u3001\u4ee5\u4e0b\u306e\u70b9\u306b\u3082\u6ce8\u610f\u3055\u308c\u305f\u3057\u3002 LoadBalancer Service \u306e\u4f5c\u6210 \u30eb\u30fc\u30eb\u306b\u4e00\u81f4\u3057\u306a\u3044\u5834\u5408\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8ee2\u9001\u5148 Deployment \u306e\u4f5c\u6210 \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306b\u5fdc\u3058\u3066 Pod \u6570\u3092\u5909\u3048\u3089\u3048\u308b\u3088\u3046\u306b\u3001 Horizontal Pod Autoscaler \u306e\u5229\u7528\u3092\u691c\u8a0e Ingress \u30ea\u30bd\u30fc\u30b9\u306e\u4f5c\u6210 # \u300c\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9 + Service \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u300d\u306e\u30da\u30a2\u3067\u6307\u5b9a\u3059\u308b\u3002 1 \u3064\u306e IP \u30a2\u30c9\u30ec\u30b9\u3067\u8907\u6570\u30db\u30b9\u30c8\u540d\u3092\u6271\u3048\u308b\u3002 \u300cGKE \u30bf\u30a4\u30d7\u300d\u3068\u300cNginx \u30bf\u30a4\u30d7\u300d\u3067\u5b9a\u7fa9\u53ef\u80fd\u306a\u8a2d\u5b9a\u306f\u5927\u4f53\u540c\u3058\u3002 \u4ee5\u4e0b\u3067\u306f\u30012. Nginx Ingress \u306e\u5834\u5408\u306e\u4f8b\u3092\u793a\u3059\u3002 ingress-nginx.yaml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 apiVersion : networking.k8s.io/v1 kind : Ingress metadata : name : ingress-myservicea annotations : # Nginx Ingress \u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067 HTTP -> HTTPS \u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u308b\u305f\u3081\u3001\u4eca\u56de\u306f\u305d\u308c\u3092 OFF nginx.ingress.kubernetes.io/ssl-redirect : \"false\" spec : rules : - host : myservice.foo.org http : paths : - path : /path1/* pathType : Prefix backend : service : name : myservice1 port : number : 80 - path : /path2/* pathType : Prefix backend : service : name : myservice2 port : number : 80 ingressClassName : nginx Ingress Class \u306b\u3088\u308b Ingress \u306e\u5206\u5272 # Nginx Ingress Controller \u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u9069\u5207\u306a Ingress \u30ea\u30bd\u30fc\u30b9\u3092\u898b\u3064\u3051\u308b\u969b\u306b\u885d\u7a81\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u30af\u30e9\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u3053\u308c\u3092\u907f\u3051\u308b\u3002 YAML 1 2 3 4 5 6 7 8 # kubernetes < 1.19 metadata : name : ingress-myserviceb annotations : kubernetes.io/ingress.class : \"nginx\" # kubernetes >= 1.19.x ingressClassName : nginx","title":"Ingress"},{"location":"kubernetes-study-ingress/#ingress","text":"","title":"Ingress"},{"location":"kubernetes-study-ingress/#ingress_1","text":"Ingress \u306f Ingress \u30ea\u30bd\u30fc\u30b9 \u304a\u3088\u3073 Ingress Controller \u306a\u3069\u3092\u6307\u3059\u3002 Ingress \u30ea\u30bd\u30fc\u30b9\u306f kind: Ingress \u306e \u30de\u30cb\u30d5\u30a7\u30b9\u30c8 \u3092\u767b\u9332\u3059\u308b\u3053\u3068\u3067\u4f5c\u6210\u3055\u308c\u3001\u305d\u306e\u767b\u9332\u6642\u306b\u4f55\u3089\u304b\u306e\u51e6\u7406\u3092\u884c\u3046\u3082\u306e\u304c Ingress Controller \u3067\u3042\u308b\u3002 \u3053\u308c\u3089\u306b\u3088\u308a\u3001\u30ce\u30fc\u30de\u30eb\u306a Service \u3067\u306f\u5b9f\u73fe\u56f0\u96e3\u306a\u3088\u308a\u9ad8\u6a5f\u80fd\u306a\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u53ef\u80fd\u3068\u306a\u308b\u3002Ingress \u306f L7 \u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3092\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u3002 LB \u306e\u7a2e\u985e \u6a5f\u80fd \u4f8b L4 IP \u30a2\u30c9\u30ec\u30b9\u3068\u30dd\u30fc\u30c8\u756a\u53f7\u306b\u3088\u308b\u8ca0\u8377\u5206\u6563 AWS \u306e Application Load Balancer L7 URL \u3084 HTTP \u30d8\u30c3\u30c0\u30fc\u3067\u8ca0\u8377\u5206\u6563 AWS \u306e Network Load Balancer","title":"Ingress \u3068\u306f\uff1f"},{"location":"kubernetes-study-ingress/#ingress_2","text":"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u89b3\u70b9\u304b\u3089 2 \u3064\u306b\u5927\u5225\u3055\u308c\u308b\u3002","title":"Ingress \u306e\u7a2e\u985e"},{"location":"kubernetes-study-ingress/#1-gke-ingress","text":"\u30af\u30e9\u30b9\u30bf\u5916\u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u7acb\u3066\u308b\u3082\u306e\u3002 \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306e\u6d41\u308c 1 \u5916\u90e8\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5(GCLB) -> (NodePort \u7d4c\u7531) -> \u8ee2\u9001\u5148\u306e Pod","title":"1. GKE Ingress"},{"location":"kubernetes-study-ingress/#2-nginx-ingress","text":"\u30af\u30e9\u30b9\u30bf\u5185\u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u3092\u7acb\u3066\u308b\u3082\u306e\u3002 \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306e\u6d41\u308c(Nginx Ingress) 1 LoadBalancer Service -> Nginx Pod(Nginx Ingress Controller) -> \u8ee2\u9001\u5148\u306e Pod \u3053\u3061\u3089\u306e\u30d1\u30bf\u30fc\u30f3\u306e\u5834\u5408\u3001\u8003\u616e\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u70b9\u304c\u591a\u304f\u3001Ingress \u7528 Pod \u306b\u5916\u90e8\u304b\u3089\u30a2\u30af\u30bb\u30b9\u3055\u305b\u308b\u305f\u3081\u306b LoadBalancer Service \u3092\u7acb\u3066\u305f\u308a\u3001Ingress \u7528\u306e Pod \u306b\u51e6\u7406\u304c\u96c6\u4e2d\u3059\u308b\u3053\u3068\u3092\u60f3\u5b9a\u3057\u3066\u30aa\u30fc\u30c8\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u3092\u8003\u616e\u3059\u308b\u5fc5\u8981\u3082\u51fa\u3066\u304f\u308b\u3002","title":"2. Nginx Ingress"},{"location":"kubernetes-study-ingress/#ingress-controller","text":"","title":"Ingress Controller \u306e\u30c7\u30d7\u30ed\u30a4"},{"location":"kubernetes-study-ingress/#1-gke-ingress_1","text":"\u30af\u30e9\u30b9\u30bf\u4f5c\u6210\u6642\u306b HttpLoadBalancer \u30a2\u30c9\u30aa\u30f3\u3092\u6709\u52b9\u5316\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u305d\u3046\u306a\u3063\u3066\u3044\u308b)\u3002","title":"1. GKE Ingress"},{"location":"kubernetes-study-ingress/#2-nginx-ingress_1","text":"Nginx Ingress Controller \u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b\u3002 1 $ kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.3.1/deploy/static/provider/cloud/deploy.yaml \u307e\u305f\u3001\u4ee5\u4e0b\u306e\u70b9\u306b\u3082\u6ce8\u610f\u3055\u308c\u305f\u3057\u3002 LoadBalancer Service \u306e\u4f5c\u6210 \u30eb\u30fc\u30eb\u306b\u4e00\u81f4\u3057\u306a\u3044\u5834\u5408\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8ee2\u9001\u5148 Deployment \u306e\u4f5c\u6210 \u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u306b\u5fdc\u3058\u3066 Pod \u6570\u3092\u5909\u3048\u3089\u3048\u308b\u3088\u3046\u306b\u3001 Horizontal Pod Autoscaler \u306e\u5229\u7528\u3092\u691c\u8a0e","title":"2. Nginx Ingress"},{"location":"kubernetes-study-ingress/#ingress_3","text":"\u300c\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30b9 + Service \u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u300d\u306e\u30da\u30a2\u3067\u6307\u5b9a\u3059\u308b\u3002 1 \u3064\u306e IP \u30a2\u30c9\u30ec\u30b9\u3067\u8907\u6570\u30db\u30b9\u30c8\u540d\u3092\u6271\u3048\u308b\u3002 \u300cGKE \u30bf\u30a4\u30d7\u300d\u3068\u300cNginx \u30bf\u30a4\u30d7\u300d\u3067\u5b9a\u7fa9\u53ef\u80fd\u306a\u8a2d\u5b9a\u306f\u5927\u4f53\u540c\u3058\u3002 \u4ee5\u4e0b\u3067\u306f\u30012. Nginx Ingress \u306e\u5834\u5408\u306e\u4f8b\u3092\u793a\u3059\u3002 ingress-nginx.yaml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 apiVersion : networking.k8s.io/v1 kind : Ingress metadata : name : ingress-myservicea annotations : # Nginx Ingress \u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067 HTTP -> HTTPS \u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\u3055\u308c\u308b\u305f\u3081\u3001\u4eca\u56de\u306f\u305d\u308c\u3092 OFF nginx.ingress.kubernetes.io/ssl-redirect : \"false\" spec : rules : - host : myservice.foo.org http : paths : - path : /path1/* pathType : Prefix backend : service : name : myservice1 port : number : 80 - path : /path2/* pathType : Prefix backend : service : name : myservice2 port : number : 80 ingressClassName : nginx","title":"Ingress \u30ea\u30bd\u30fc\u30b9\u306e\u4f5c\u6210"},{"location":"kubernetes-study-ingress/#ingress-class-ingress","text":"Nginx Ingress Controller \u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u9069\u5207\u306a Ingress \u30ea\u30bd\u30fc\u30b9\u3092\u898b\u3064\u3051\u308b\u969b\u306b\u885d\u7a81\u3057\u3066\u3057\u307e\u3046\u53ef\u80fd\u6027\u304c\u3042\u308b\u3002\u30af\u30e9\u30b9\u3092\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u3053\u308c\u3092\u907f\u3051\u308b\u3002 YAML 1 2 3 4 5 6 7 8 # kubernetes < 1.19 metadata : name : ingress-myserviceb annotations : kubernetes.io/ingress.class : \"nginx\" # kubernetes >= 1.19.x ingressClassName : nginx","title":"Ingress Class \u306b\u3088\u308b Ingress \u306e\u5206\u5272"},{"location":"kubernetes-study-service/","text":"Service # Session \u306e\u305d\u306e\u4ed6\u6a5f\u80fd # Session Affinity # Kubernetes Service \u3067\u306f\u3001Session Affinity \u3068\u3044\u3046\u6a5f\u80fd\u3092\u6709\u52b9\u5316\u3067\u304d\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f OFF)\u3002\u3053\u306e\u6a5f\u80fd\u306f\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u5916\u90e8\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5404 Pod \u306b\u9001\u3089\u308c\u308b\u3068\u304d\u3001\u540c\u3058\u30ea\u30af\u30a8\u30b9\u30c8\u5143\u306b\u5bfe\u3057\u3066\u306f\u305d\u306e\u5f8c\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u3082\u305a\u3063\u3068\u540c\u3058 Pod \u306b\u5bfe\u3057\u3066\u9001\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3082\u306e\u3002 \u4e0b\u306e\u4f8b\u306f\u3001ClusterIP Service \u3067 Session Affinity \u3092\u6709\u52b9\u5316\u3059\u308b\u8a2d\u5b9a\u3067\u3042\u308b\u3002 sessionAffinityConfig.clientIP.timeoutSeconds \u3067\u4f55\u79d2\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4fdd\u6301\u3059\u308b\u304b\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 apiVersion : v1 kind : Service metadata : name : my-service spec : type : ClusterIP selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 sessionAffinity : ClientIP sessionAffinityConfig : clientIP : timeoutSeconds : 10 \u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u4ed6\u306e\u7a2e\u985e\u306e Service(NodePort, LoadBalancer) \u3067\u3082\u5229\u7528\u53ef\u80fd\u3067\u3042\u308b\u304c\u3001\u3042\u307e\u308a\u6709\u7528\u3067\u306f\u306a\u3044\u3002\u4f8b\u3048\u3070\u3001NodePort Service \u3067\u306f\u3001\u3069\u306e NodePort \u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8ee2\u9001\u3059\u308b\u304b\u306b\u3088\u3063\u3066\u3001\u540c\u3058\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 IP \u30a2\u30c9\u30ec\u30b9\u3067\u3082\u540c\u3058 Pod \u306b\u8ee2\u9001\u3055\u308c\u308b\u3068\u306f\u9650\u3089\u306a\u3044(\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 \u2192Node \u304c\u56fa\u5b9a\u3067\u3082\u3001\u7d50\u5c40 Node \u2192 Pod \u3067\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u308b\u305f\u3081)\u3002 \u30ce\u30fc\u30c9\u9593\u901a\u4fe1\u306e\u6392\u9664\u3068\u9001\u4fe1\u5143 IP \u30a2\u30c9\u30ec\u30b9\u306e\u4fdd\u6301 # NodePort/LoadBalancer Service \u3067\u306f\u3001Node \u306b\u5230\u9054\u3057\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u3055\u3089\u306b Node \u3092\u8de8\u3044\u3060 Pod \u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3055\u308c\u308b\u3002\u4e0d\u5fc5\u8981\u306a\u4e8c\u6bb5\u968e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u884c\u308f\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u3001\u5927\u304d\u306a\u30ec\u30a4\u30c6\u30f3\u30b7\u3068\u306a\u308b\u5834\u5408\u304c\u3042\u308b\u3002 \u4e00\u65b9\u3067 DaemonSet \u3067\u306f\u3001 1 Node = 1 Pod \u3067\u914d\u7f6e\u3055\u308c\u308b\u305f\u3081\u3001\u4ed6 Node \u306e Pod \u306b\u8ee2\u9001\u3057\u305f\u304f\u306a\u3044\u3053\u3068\u304c\u3042\u308b\u3002\u305d\u306e\u5834\u5408\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u5b9f\u73fe\u3067\u304d\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 apiVersion : v1 kind : Service metadata : name : my-service spec : type : NodePort selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 externalTrafficPolicy : Local \u3053\u308c\u306b\u3088\u308a\u3001\u5916\u90e8\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u3042\u308b Node \u306b\u5230\u9054\u3059\u308b\u3068\u3001\u305d\u306e Node \u306e Pod \u306e\u307f\u306b\u8ee2\u9001\u3055\u308c\u308b\u3002\u540c\u4e00 Node \u4e0a\u306b\u8907\u6570 Pod \u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306b\u306f\u3001\u305d\u308c\u3089\u306b\u5747\u7b49\u306b\u914d\u5206\u3055\u308c\u308b\u3002\u307e\u305f\u3001 NodePort Service \u306b\u304a\u3044\u3066\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f Node \u4e0a\u306b Pod \u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306b\u306f\u3001\u8ee2\u9001\u306f\u884c\u308f\u308c\u305a\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u51e6\u7406\u3055\u308c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308b\u305f\u3081\u3001\u3053\u308c\u306f\u907f\u3051\u305f\u65b9\u304c\u826f\u3044\u3060\u308d\u3046\u3002 spec.externalTrafficPolicy \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306f Cluster \u3067\u3001\u305d\u306e\u5834\u5408\u306f\u4ed6 Node \u3078\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u6709\u52b9\u3068\u306a\u3063\u3066\u3044\u308b\u3002 \u307e\u305f\u3001\u672c\u6a5f\u80fd\u306f ClusterIP Service \u3067\u306f\u5229\u7528\u4e0d\u53ef\u3067\u3042\u308b\u3002 \u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u7528 NodePort # LoadBalancer Service \u306e\u5834\u5408\u3001\u305d\u306e Node \u4e0a\u306b Pod \u304c\u5b58\u5728\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u7528\u306e NodePort \u304c\u3042\u308a\u3001 \u3053\u306e\u6a5f\u69cb\u306b\u3088\u308a Pod \u304c\u5b58\u5728\u3057\u306a\u3044 Node \u306b\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u8ee2\u9001\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002 \u3053\u306e\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u7528 NodePort \u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 apiVersion : v1 kind : Service metadata : name : my-service spec : type : LoadBalancer selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 externalTrafficPolicy : Local healthCheckNodePort : 30088 \u30c8\u30dc\u30ed\u30b8\u3092\u610f\u8b58\u3057\u305f Service \u8ee2\u9001 # \u57fa\u672c\u7684(\u30c7\u30d5\u30a9\u30eb\u30c8)\u306b\u306f\u3001Service \u306b\u3088\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u8ee2\u9001\u5148 Pod \u306f\u30ea\u30fc\u30b8\u30e7\u30f3\u3084\u30a2\u30d9\u30a4\u30e9\u30d3\u30ea\u30c6\u30a3\u30be\u30fc\u30f3\u3092\u8003\u616e\u3057\u306a\u3044\u3002\u305d\u308c\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u4f4e\u4e0b\u3092\u907f\u3051\u308b\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u3088\u3044\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 apiVersion : v1 kind : Service metadata : name : my-service spec : type : ClusterIP selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 topologyKeys : - kubernetes.io/hostname #\u512a\u5148\u5ea61: \u540c\u4e00 Node - \"*\" #\u512a\u5148\u5ea62: \u5168\u3066\u306e Pod \u304c\u5bfe\u8c61 spec.topologyKeys \u306b\u306f\u3069\u306e\u30c8\u30dd\u30ed\u30b8\u306e\u7bc4\u56f2\u306b\u8ee2\u9001\u3092\u8a66\u307f\u308b\u304b\u3092\u512a\u5148\u5ea6\u9806\u306b\u6307\u5b9a\u3059\u308b\u3002\u4e0a\u8a18\u4f8b\u3067\u306f\u3001\u307e\u305a\u8ee2\u9001\u5143 Pod \u3068\u540c\u4e00 Node \u306b\u3042\u308b Pod \u3078\u306e\u8ee2\u9001\u3092\u8a66\u307f\u3001\u305d\u308c\u3067\u3082\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u5834\u5408\u306f\u3001\u5225\u306e Node \u306b\u3042\u308b Pod \u3078\u306e\u8ee2\u9001\u3092\u8a66\u307f\u308b\u3002 spec.topologyKeys \u306b\u8a2d\u5b9a\u53ef\u80fd\u306a\u30e9\u30d9\u30eb # \u30e9\u30d9\u30eb \u7bc4\u56f2 kubernetes.io/hostname \u540c\u4e00 Node kubernetes.io/zone \u540c\u4e00 \u30be\u30fc\u30f3 kubernetes.io/region \u540c\u4e00 \u30ea\u30fc\u30b8\u30e7\u30f3 * \u3044\u305a\u308c\u304b\u306e Node \u203b \u300c*\u300d\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001\u512a\u5148\u5ea6\u3092\u4e00\u756a\u4f4e\u304f\u3059\u308b\u3053\u3068 \u305d\u306e\u4ed6\u306e Service # Headless Service # \u5bfe\u8c61\u3068\u306a\u308b\u500b\u3005\u306e Pod \u306e IP \u30a2\u30c9\u30ec\u30b9\u304c\u76f4\u63a5\u8fd4\u3063\u3066\u304f\u308b Service\u3002 \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3059\u308b\u305f\u3081\u306e IP \u30a2\u30c9\u30ec\u30b9\u306f\u63d0\u4f9b\u3055\u308c\u305a\u3001DNS Round Robin \u3092\u4f7f\u3063\u305f\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u63d0\u4f9b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 apiVersion : v1 kind : Service metadata : name : my-service spec : type : ClusterIP clusterIP : None selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 Pod \u540d\u306b\u3088\u308b\u540d\u524d\u89e3\u6c7a # \u4ee5\u4e0b\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3068\u304d\u3001Pod \u540d\u304b\u3089\u305d\u306e IP \u30a2\u30c9\u30ec\u30b9\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 [Pod \u540d].[Service \u540d].[Namespace \u540d].svc.cluster.local \u6761\u4ef6: StatefulSet \u304c Headless Service \u3092\u5229\u7528\u3057\u3066\u3044\u308b Service \u306e metadata.name \u304c StatefulSet \u306e spec.serviceName \u3068\u540c\u3058 StatefulSet \u4ee5\u5916\u306e Pod \u540d\u306e\u540d\u524d\u89e3\u6c7a # \u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u3053\u3068\u3067\u3001StatefulSet \u4ee5\u5916\u306e Pod \u306b\u5bfe\u3057\u3066\u3082\u540d\u524d\u89e3\u6c7a\u304c\u53ef\u80fd\u3068\u306a\u308b\u3002 Pod \u306e spec.hostname \u306e\u8a2d\u5b9a Headless Service \u306e metadata.name \u3068\u540c\u3058 spec.subdomain \u306e\u8a2d\u5b9a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 apiVersion : v1 kind : Service metadata : name : default-subdomain spec : selector : name : busybox clusterIP : None ports : - name : foo port : 1234 targetPort : 1234 --- apiVersion : v1 kind : Pod metadata : name : busybox1 labels : name : busybox spec : hostname : busybox-1 subdomain : default-subdomain containers : - image : busybox:1.28 command : - sleep - \"3600\" name : busybox ExternalName Service # Service \u540d\u306e\u540d\u524d\u89e3\u6c7a\u306b\u5bfe\u3057\u3066\u5916\u90e8\u306e\u30c9\u30e1\u30a4\u30f3\u5b9b\u306e CNAME(\u30a8\u30a4\u30ea\u30a2\u30b9\u7684\u306a) \u3092\u8fd4\u3059\u3002 \u30b5\u30fc\u30d3\u30b9\u306e\u30db\u30b9\u30c8\u540d\u306b\u5225\u540d\u3092\u5f53\u3066\u308b\u76ee\u7684\u306a\u3069\u3067\u4f7f\u7528\u3055\u308c\u308b\u3002 1 2 3 4 5 6 7 apiVersion : v1 kind : Service metadata : name : sample-externalname spec : type : ExternalName externalName : thisis.externalname.com Non-Selector Service # Kubernetes \u5185\u306b\u81ea\u7531\u306a\u5b9b\u5148\u3067\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u6a5f\u80fd\u3092\u4f5c\u6210\u3067\u304d\u308b\u3002 \u4f8b\u3048\u3070\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30af\u30e9\u30b9\u30bf\u5916\u90e8\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u306b\u5206\u6563\u3057\u305f\u308a\u3001\u74b0\u5883\u306b\u3088\u3063\u3066\u30af\u30e9\u30b9\u30bf\u5185\u90e8/\u5916\u90e8\u3092\u5207\u308a\u66ff\u3048\u305f\u308a\u3059\u308b\u306e\u306b\u6709\u7528\u3002 \u57fa\u672c\u7684\u306b\u306f\u3001 type=ClusterIP \u3068\u3057\u3001externalName \u304a\u3088\u3073 Selector \u3092\u6307\u5b9a\u3057\u306a\u3044\u3053\u3068\u3067\u3001 Non-Selector Service \u3092\u4f5c\u6210\u3067\u304d\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 apiVersion : v1 kind : Service metadata : name : sample-externalname spec : type : ClusterIP ports : name : hoge protocol : TCP port : 80 targetPort : 80","title":"Service"},{"location":"kubernetes-study-service/#service","text":"","title":"Service"},{"location":"kubernetes-study-service/#session","text":"","title":"Session \u306e\u305d\u306e\u4ed6\u6a5f\u80fd"},{"location":"kubernetes-study-service/#session-affinity","text":"Kubernetes Service \u3067\u306f\u3001Session Affinity \u3068\u3044\u3046\u6a5f\u80fd\u3092\u6709\u52b9\u5316\u3067\u304d\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f OFF)\u3002\u3053\u306e\u6a5f\u80fd\u306f\u3001\u30af\u30e9\u30b9\u30bf\u30fc\u5916\u90e8\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u5404 Pod \u306b\u9001\u3089\u308c\u308b\u3068\u304d\u3001\u540c\u3058\u30ea\u30af\u30a8\u30b9\u30c8\u5143\u306b\u5bfe\u3057\u3066\u306f\u305d\u306e\u5f8c\u306e\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u3082\u305a\u3063\u3068\u540c\u3058 Pod \u306b\u5bfe\u3057\u3066\u9001\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3082\u306e\u3002 \u4e0b\u306e\u4f8b\u306f\u3001ClusterIP Service \u3067 Session Affinity \u3092\u6709\u52b9\u5316\u3059\u308b\u8a2d\u5b9a\u3067\u3042\u308b\u3002 sessionAffinityConfig.clientIP.timeoutSeconds \u3067\u4f55\u79d2\u30bb\u30c3\u30b7\u30e7\u30f3\u3092\u4fdd\u6301\u3059\u308b\u304b\u3092\u6307\u5b9a\u3067\u304d\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 apiVersion : v1 kind : Service metadata : name : my-service spec : type : ClusterIP selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 sessionAffinity : ClientIP sessionAffinityConfig : clientIP : timeoutSeconds : 10 \u6ce8\u610f\u70b9\u3068\u3057\u3066\u3001\u4ed6\u306e\u7a2e\u985e\u306e Service(NodePort, LoadBalancer) \u3067\u3082\u5229\u7528\u53ef\u80fd\u3067\u3042\u308b\u304c\u3001\u3042\u307e\u308a\u6709\u7528\u3067\u306f\u306a\u3044\u3002\u4f8b\u3048\u3070\u3001NodePort Service \u3067\u306f\u3001\u3069\u306e NodePort \u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u8ee2\u9001\u3059\u308b\u304b\u306b\u3088\u3063\u3066\u3001\u540c\u3058\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 IP \u30a2\u30c9\u30ec\u30b9\u3067\u3082\u540c\u3058 Pod \u306b\u8ee2\u9001\u3055\u308c\u308b\u3068\u306f\u9650\u3089\u306a\u3044(\u30af\u30e9\u30a4\u30a2\u30f3\u30c8 \u2192Node \u304c\u56fa\u5b9a\u3067\u3082\u3001\u7d50\u5c40 Node \u2192 Pod \u3067\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u632f\u308a\u5206\u3051\u3089\u308c\u308b\u305f\u3081)\u3002","title":"Session Affinity"},{"location":"kubernetes-study-service/#ip","text":"NodePort/LoadBalancer Service \u3067\u306f\u3001Node \u306b\u5230\u9054\u3057\u305f\u30ea\u30af\u30a8\u30b9\u30c8\u306f\u3055\u3089\u306b Node \u3092\u8de8\u3044\u3060 Pod \u306b\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3055\u308c\u308b\u3002\u4e0d\u5fc5\u8981\u306a\u4e8c\u6bb5\u968e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u884c\u308f\u308c\u308b\u3053\u3068\u306b\u306a\u308a\u3001\u5927\u304d\u306a\u30ec\u30a4\u30c6\u30f3\u30b7\u3068\u306a\u308b\u5834\u5408\u304c\u3042\u308b\u3002 \u4e00\u65b9\u3067 DaemonSet \u3067\u306f\u3001 1 Node = 1 Pod \u3067\u914d\u7f6e\u3055\u308c\u308b\u305f\u3081\u3001\u4ed6 Node \u306e Pod \u306b\u8ee2\u9001\u3057\u305f\u304f\u306a\u3044\u3053\u3068\u304c\u3042\u308b\u3002\u305d\u306e\u5834\u5408\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3057\u3066\u5b9f\u73fe\u3067\u304d\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 apiVersion : v1 kind : Service metadata : name : my-service spec : type : NodePort selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 externalTrafficPolicy : Local \u3053\u308c\u306b\u3088\u308a\u3001\u5916\u90e8\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u3042\u308b Node \u306b\u5230\u9054\u3059\u308b\u3068\u3001\u305d\u306e Node \u306e Pod \u306e\u307f\u306b\u8ee2\u9001\u3055\u308c\u308b\u3002\u540c\u4e00 Node \u4e0a\u306b\u8907\u6570 Pod \u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306b\u306f\u3001\u305d\u308c\u3089\u306b\u5747\u7b49\u306b\u914d\u5206\u3055\u308c\u308b\u3002\u307e\u305f\u3001 NodePort Service \u306b\u304a\u3044\u3066\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u53d7\u3051\u305f Node \u4e0a\u306b Pod \u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306b\u306f\u3001\u8ee2\u9001\u306f\u884c\u308f\u308c\u305a\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u51e6\u7406\u3055\u308c\u306a\u3044\u3068\u3044\u3046\u3053\u3068\u306b\u306a\u308b\u305f\u3081\u3001\u3053\u308c\u306f\u907f\u3051\u305f\u65b9\u304c\u826f\u3044\u3060\u308d\u3046\u3002 spec.externalTrafficPolicy \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u306f Cluster \u3067\u3001\u305d\u306e\u5834\u5408\u306f\u4ed6 Node \u3078\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u304c\u6709\u52b9\u3068\u306a\u3063\u3066\u3044\u308b\u3002 \u307e\u305f\u3001\u672c\u6a5f\u80fd\u306f ClusterIP Service \u3067\u306f\u5229\u7528\u4e0d\u53ef\u3067\u3042\u308b\u3002","title":"\u30ce\u30fc\u30c9\u9593\u901a\u4fe1\u306e\u6392\u9664\u3068\u9001\u4fe1\u5143 IP \u30a2\u30c9\u30ec\u30b9\u306e\u4fdd\u6301"},{"location":"kubernetes-study-service/#nodeport","text":"LoadBalancer Service \u306e\u5834\u5408\u3001\u305d\u306e Node \u4e0a\u306b Pod \u304c\u5b58\u5728\u3059\u308b\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d\u3059\u308b\u7528\u306e NodePort \u304c\u3042\u308a\u3001 \u3053\u306e\u6a5f\u69cb\u306b\u3088\u308a Pod \u304c\u5b58\u5728\u3057\u306a\u3044 Node \u306b\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u8ee2\u9001\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\u3002 \u3053\u306e\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u7528 NodePort \u3092\u660e\u793a\u7684\u306b\u6307\u5b9a\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 apiVersion : v1 kind : Service metadata : name : my-service spec : type : LoadBalancer selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 externalTrafficPolicy : Local healthCheckNodePort : 30088","title":"\u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\u7528 NodePort"},{"location":"kubernetes-study-service/#service_1","text":"\u57fa\u672c\u7684(\u30c7\u30d5\u30a9\u30eb\u30c8)\u306b\u306f\u3001Service \u306b\u3088\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u8ee2\u9001\u5148 Pod \u306f\u30ea\u30fc\u30b8\u30e7\u30f3\u3084\u30a2\u30d9\u30a4\u30e9\u30d3\u30ea\u30c6\u30a3\u30be\u30fc\u30f3\u3092\u8003\u616e\u3057\u306a\u3044\u3002\u305d\u308c\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306e\u4f4e\u4e0b\u3092\u907f\u3051\u308b\u305f\u3081\u306b\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u3059\u308b\u3068\u3088\u3044\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 apiVersion : v1 kind : Service metadata : name : my-service spec : type : ClusterIP selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376 topologyKeys : - kubernetes.io/hostname #\u512a\u5148\u5ea61: \u540c\u4e00 Node - \"*\" #\u512a\u5148\u5ea62: \u5168\u3066\u306e Pod \u304c\u5bfe\u8c61 spec.topologyKeys \u306b\u306f\u3069\u306e\u30c8\u30dd\u30ed\u30b8\u306e\u7bc4\u56f2\u306b\u8ee2\u9001\u3092\u8a66\u307f\u308b\u304b\u3092\u512a\u5148\u5ea6\u9806\u306b\u6307\u5b9a\u3059\u308b\u3002\u4e0a\u8a18\u4f8b\u3067\u306f\u3001\u307e\u305a\u8ee2\u9001\u5143 Pod \u3068\u540c\u4e00 Node \u306b\u3042\u308b Pod \u3078\u306e\u8ee2\u9001\u3092\u8a66\u307f\u3001\u305d\u308c\u3067\u3082\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f\u5834\u5408\u306f\u3001\u5225\u306e Node \u306b\u3042\u308b Pod \u3078\u306e\u8ee2\u9001\u3092\u8a66\u307f\u308b\u3002","title":"\u30c8\u30dc\u30ed\u30b8\u3092\u610f\u8b58\u3057\u305f Service \u8ee2\u9001"},{"location":"kubernetes-study-service/#spectopologykeys","text":"\u30e9\u30d9\u30eb \u7bc4\u56f2 kubernetes.io/hostname \u540c\u4e00 Node kubernetes.io/zone \u540c\u4e00 \u30be\u30fc\u30f3 kubernetes.io/region \u540c\u4e00 \u30ea\u30fc\u30b8\u30e7\u30f3 * \u3044\u305a\u308c\u304b\u306e Node \u203b \u300c*\u300d\u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f\u3001\u512a\u5148\u5ea6\u3092\u4e00\u756a\u4f4e\u304f\u3059\u308b\u3053\u3068","title":"spec.topologyKeys \u306b\u8a2d\u5b9a\u53ef\u80fd\u306a\u30e9\u30d9\u30eb"},{"location":"kubernetes-study-service/#service_2","text":"","title":"\u305d\u306e\u4ed6\u306e Service"},{"location":"kubernetes-study-service/#headless-service","text":"\u5bfe\u8c61\u3068\u306a\u308b\u500b\u3005\u306e Pod \u306e IP \u30a2\u30c9\u30ec\u30b9\u304c\u76f4\u63a5\u8fd4\u3063\u3066\u304f\u308b Service\u3002 \u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u3059\u308b\u305f\u3081\u306e IP \u30a2\u30c9\u30ec\u30b9\u306f\u63d0\u4f9b\u3055\u308c\u305a\u3001DNS Round Robin \u3092\u4f7f\u3063\u305f\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3092\u63d0\u4f9b\u3002 1 2 3 4 5 6 7 8 9 10 11 12 13 apiVersion : v1 kind : Service metadata : name : my-service spec : type : ClusterIP clusterIP : None selector : app.kubernetes.io/name : MyApp ports : - protocol : TCP port : 80 targetPort : 9376","title":"Headless Service"},{"location":"kubernetes-study-service/#pod","text":"\u4ee5\u4e0b\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3068\u304d\u3001Pod \u540d\u304b\u3089\u305d\u306e IP \u30a2\u30c9\u30ec\u30b9\u3092\u53d6\u5f97\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u308b\u3002 [Pod \u540d].[Service \u540d].[Namespace \u540d].svc.cluster.local \u6761\u4ef6: StatefulSet \u304c Headless Service \u3092\u5229\u7528\u3057\u3066\u3044\u308b Service \u306e metadata.name \u304c StatefulSet \u306e spec.serviceName \u3068\u540c\u3058","title":"Pod \u540d\u306b\u3088\u308b\u540d\u524d\u89e3\u6c7a"},{"location":"kubernetes-study-service/#statefulset-pod","text":"\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u3053\u3068\u3067\u3001StatefulSet \u4ee5\u5916\u306e Pod \u306b\u5bfe\u3057\u3066\u3082\u540d\u524d\u89e3\u6c7a\u304c\u53ef\u80fd\u3068\u306a\u308b\u3002 Pod \u306e spec.hostname \u306e\u8a2d\u5b9a Headless Service \u306e metadata.name \u3068\u540c\u3058 spec.subdomain \u306e\u8a2d\u5b9a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 apiVersion : v1 kind : Service metadata : name : default-subdomain spec : selector : name : busybox clusterIP : None ports : - name : foo port : 1234 targetPort : 1234 --- apiVersion : v1 kind : Pod metadata : name : busybox1 labels : name : busybox spec : hostname : busybox-1 subdomain : default-subdomain containers : - image : busybox:1.28 command : - sleep - \"3600\" name : busybox","title":"StatefulSet \u4ee5\u5916\u306e Pod \u540d\u306e\u540d\u524d\u89e3\u6c7a"},{"location":"kubernetes-study-service/#externalname-service","text":"Service \u540d\u306e\u540d\u524d\u89e3\u6c7a\u306b\u5bfe\u3057\u3066\u5916\u90e8\u306e\u30c9\u30e1\u30a4\u30f3\u5b9b\u306e CNAME(\u30a8\u30a4\u30ea\u30a2\u30b9\u7684\u306a) \u3092\u8fd4\u3059\u3002 \u30b5\u30fc\u30d3\u30b9\u306e\u30db\u30b9\u30c8\u540d\u306b\u5225\u540d\u3092\u5f53\u3066\u308b\u76ee\u7684\u306a\u3069\u3067\u4f7f\u7528\u3055\u308c\u308b\u3002 1 2 3 4 5 6 7 apiVersion : v1 kind : Service metadata : name : sample-externalname spec : type : ExternalName externalName : thisis.externalname.com","title":"ExternalName Service"},{"location":"kubernetes-study-service/#non-selector-service","text":"Kubernetes \u5185\u306b\u81ea\u7531\u306a\u5b9b\u5148\u3067\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b7\u30f3\u30b0\u6a5f\u80fd\u3092\u4f5c\u6210\u3067\u304d\u308b\u3002 \u4f8b\u3048\u3070\u3001\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u30af\u30e9\u30b9\u30bf\u5916\u90e8\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u306b\u5206\u6563\u3057\u305f\u308a\u3001\u74b0\u5883\u306b\u3088\u3063\u3066\u30af\u30e9\u30b9\u30bf\u5185\u90e8/\u5916\u90e8\u3092\u5207\u308a\u66ff\u3048\u305f\u308a\u3059\u308b\u306e\u306b\u6709\u7528\u3002 \u57fa\u672c\u7684\u306b\u306f\u3001 type=ClusterIP \u3068\u3057\u3001externalName \u304a\u3088\u3073 Selector \u3092\u6307\u5b9a\u3057\u306a\u3044\u3053\u3068\u3067\u3001 Non-Selector Service \u3092\u4f5c\u6210\u3067\u304d\u308b\u3002 1 2 3 4 5 6 7 8 9 10 11 apiVersion : v1 kind : Service metadata : name : sample-externalname spec : type : ClusterIP ports : name : hoge protocol : TCP port : 80 targetPort : 80","title":"Non-Selector Service"},{"location":"setting/","text":"Setting up # There are several points to edit and setting up. Metadata # mkdocs.yml 1 2 3 4 5 6 # metadata site_name : Docs docs_dir : src # document root repo_url : https://github.ibm.com/ClientEngineeringJapan/docs repo_name : ClientEngineeringJapan/docs edit_uri : \"\" Language # mkdocs.yml 1 2 3 4 5 6 7 8 # theme theme : name : material language : ja icon : repo : fontawesome/brands/github logo : img/logo.png favicon : img/logo.png Logo and Favicon # mkdocs.yml 1 2 3 4 5 6 7 8 # theme theme : name : material language : ja icon : repo : fontawesome/brands/github logo : img/logo.png favicon : img/logo.png","title":"Setting up"},{"location":"setting/#setting-up","text":"There are several points to edit and setting up.","title":"Setting up"},{"location":"setting/#metadata","text":"mkdocs.yml 1 2 3 4 5 6 # metadata site_name : Docs docs_dir : src # document root repo_url : https://github.ibm.com/ClientEngineeringJapan/docs repo_name : ClientEngineeringJapan/docs edit_uri : \"\"","title":"Metadata"},{"location":"setting/#language","text":"mkdocs.yml 1 2 3 4 5 6 7 8 # theme theme : name : material language : ja icon : repo : fontawesome/brands/github logo : img/logo.png favicon : img/logo.png","title":"Language"},{"location":"setting/#logo-and-favicon","text":"mkdocs.yml 1 2 3 4 5 6 7 8 # theme theme : name : material language : ja icon : repo : fontawesome/brands/github logo : img/logo.png favicon : img/logo.png","title":"Logo and Favicon"}]}